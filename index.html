    <script>
        // Configuración de la API de Google Sheets
        const SHEET_ID = '1k7gBdZwyHrZ0AJYSudI_lvE702qoYu-1D-tRlCmI5Ws';
        const API_KEY = 'AIzaSyAgm2abFGywtXF3ZXxOEVsiJQZu9DO7_hI';
        const RANGO = 'Equipos!A2:E'; // Modificado para incluir 5 columnas

        // ... resto del código ...

        async function buscar() {
            const valor = buscarDescripcion.value.trim().toUpperCase();
            resultados.innerHTML = "";
            infoDetallada.innerHTML = "";

            if (valor.length > 0) {
                const datos = await obtenerDatosDeSheets();
                
                const filtrados = datos.filter(([codigoEricsson, descripcionEricsson, codigoSAP, descripcionSAP, aplicaRMA]) => 
                    (codigoEricsson && codigoEricsson.toUpperCase().includes(valor)) || 
                    (descripcionEricsson && descripcionEricsson.toUpperCase().includes(valor)) ||
                    (codigoSAP && codigoSAP.toUpperCase().includes(valor)) ||
                    (descripcionSAP && descripcionSAP.toUpperCase().includes(valor)) ||
                    (aplicaRMA && aplicaRMA.toUpperCase().includes(valor))
                );

                if (filtrados.length > 0) {
                    filtrados.forEach(([codigoEricsson, descripcionEricsson, codigoSAP, descripcionSAP, aplicaRMA]) => {
                        const div = document.createElement("div");
                        div.innerHTML = `
                            <span class="codigo">${codigoEricsson}</span> - 
                            <span class="descripcion">${descripcionEricsson}</span> - 
                            <span class="codigo">${codigoSAP}</span> - 
                            <span class="descripcion">${descripcionSAP}</span> - 
                            <span class="infoC">${aplicaRMA}</span>
                        `;
                        div.onclick = () => {
                            buscarDescripcion.value = descripcionEricsson;
                            resultados.innerHTML = "";
                            mostrarInfoDetallada(codigoEricsson, descripcionEricsson, codigoSAP, descripcionSAP, aplicaRMA);
                        };
                        resultados.appendChild(div);
                    });
                } else {
                    resultados.innerHTML = "<div>No se encontraron coincidencias.</div>";
                }
            } else {
                resultados.innerHTML = "<div>Por favor, escribe algo para buscar.</div>";
            }
        }

        function mostrarInfoDetallada(codigoEricsson, descripcionEricsson, codigoSAP, descripcionSAP, aplicaRMA) {
            infoDetallada.innerHTML = `
                <h3>Información Detallada</h3>
                <p><strong>Código Ericsson:</strong> ${codigoEricsson}</p>
                <p><strong>Descripción Ericsson:</strong> ${descripcionEricsson}</p>
                <p><strong>Código SAP:</strong> ${codigoSAP}</p>
                <p><strong>Descripción SAP:</strong> ${descripcionSAP}</p>
                <p><strong>Aplica RMA (Según lista 18/03/25):</strong> ${aplicaRMA}</p>
            `;
        }
    </script>
